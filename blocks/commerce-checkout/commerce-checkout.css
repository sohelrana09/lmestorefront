.checkout__content {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--spacing-big) 0;
}

.checkout__merged-cart-banner {
    display: grid;
    grid-column: 1 / -1;
    align-items: start;
    grid-template-columns: auto;
}

.checkout__main {
    display: grid;
    row-gap: var(--spacing-xbig);
    margin-top: var(--spacing-medium);
}

.checkout__aside {
    display: grid;
    gap: var(--spacing-xbig);
}

.checkout-header h1 {
    margin: 0;
}

/* Block dividers */
.checkout__block.checkout__heading .dropin-header-container {
    gap: var(--spacing-xsmall);
}

.checkout__shipping-form {
    padding-top: var(--spacing-xbig);
    border-top: var(--shape-border-width-3) solid var(--color-neutral-400);
}

.checkout__payment-methods {
    padding-top: var(--spacing-xbig);
    border-top: var(--shape-border-width-3) solid var(--color-neutral-400);
    padding-bottom: var(--spacing-xbig);
    border-bottom: var(--shape-border-width-3) solid var(--color-neutral-400);
}

/* Server error visibility */
.checkout__server-error {
    display: none;
}

/* Show when it contains actual error content */
.checkout__server-error:has(.dropin-illustrated-message) {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
}

/* Safari fallback: show when not empty, but this may show empty divs briefly */
@supports not selector(:has(*)) {
    .checkout__server-error:not(:empty) {
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
    }
}

/* Hide empty blocks */
.checkout__block:empty {
    display: none;
}

/* Hide main containers when the cart is empty or there is a server error */
.checkout__content--error .checkout__merged-cart-banner,
.checkout__content--error .checkout__out-of-stock,
.checkout__content--error .checkout__login,
.checkout__content--error .checkout__shipping-form,
.checkout__content--error .checkout__bill-to-shipping,
.checkout__content--error .checkout__delivery,
.checkout__content--error .checkout__payment-methods,
.checkout__content--error .checkout__billing-form,
.checkout__content--error .checkout__terms-and-conditions,
.checkout__content--empty .checkout__merged-cart-banner,
.checkout__content--empty .checkout__server-error,
.checkout__content--empty .checkout__out-of-stock,
.checkout__content--empty .checkout__login,
.checkout__content--empty .checkout__shipping-form,
.checkout__content--empty .checkout__bill-to-shipping,
.checkout__content--empty .checkout__delivery,
.checkout__content--empty .checkout__payment-methods,
.checkout__content--empty .checkout__billing-form,
.checkout__content--empty .checkout__terms-and-conditions {
    display: none !important;
}

/* Hide blocks with empty divs */
.checkout__out-of-stock:has(> :empty),
.checkout__merged-cart-banner:has(> :empty),
.checkout__delivery:has(> div:first-child:empty),
.checkout__bill-to-shipping:has(> :empty),
.checkout__gift-options:has(.cart-gift-options-view--readonly:empty) {
    display: none;
}

/* Hide aside containers when the cart is empty or there is a server error */
.checkout__content--error .checkout__aside,
.checkout__content--empty .checkout__aside {
    display: none;
}

/* Integrate place order button into Order Summary - mobile */
.checkout__place-order {
    grid-column: unset;
    justify-items: unset;
    margin-top: calc(var(--spacing-big) * -1);
}

/* Hide the place order button when the cart is empty or there is a server error */
.checkout__content--error .checkout__place-order,
.checkout__content--empty .checkout__place-order {
    display: none;
}

.checkout__loader {
    align-items: center;
    background: var(--color-neutral-50);
    display: flex;
    height: 100vh;
    justify-content: center;
    left: 0;
    opacity: 0.5;
    position: fixed;
    top: 0;
    width: 100%;
    z-index: 9999;
}

.checkout__loader:empty {
    display: none;
}

/* remove margin from the heading divider */
.checkout__heading .dropin-divider {
    margin: 0;
}

/* Cart Summary */
.checkout__block .cart-cart-summary-list {
    padding: var(--spacing-medium);
}

/* Order Summary Coupon */
.dropin-accordion-section__heading {
    margin: var(--spacing-medium) auto;
}

.cart-coupons__accordion {
    margin-top: var(--spacing-xsmall);
}

/* temporary fix to hide the default cart heading */
[data-testid="default-cart-heading"] {
    display: none;
}

.cart-summary-list__heading {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
}

.cart-summary-list__heading-text {
    font: var(--type-headline-2-strong-font);
    letter-spacing: var(--type-headline-2-strong-letter-spacing);
    color: var(--color-neutral-800);
}

.cart-cart-summary-list__heading {
    row-gap: var(--spacing-small);
    padding-top: 0;
}

.cart-cart-summary-list__heading-text {
    font: var(--type-headline-2-strong-font);
    letter-spacing: var(--type-headline-2-strong-letter-spacing);
    color: var(--color-neutral-800);
}

.cart-summary-list__edit {
    font: var(--type-body-2-strong-font);
    letter-spacing: var(--type-body-2-strong-letter-spacing);
}

.checkout__block
.cart-cart-summary-list
.cart-cart-summary-list__footer-divider {
    margin: var(--spacing-small) 0;
}

/* Sign-in modal */
#modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgb(0 0 0 / 50%);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 2;
}

#modal-form {
    width: 800px;
}

/* Address form */
.checkout__shipping-form .account-address-form-wrapper__title,
.checkout__shipping-form .dropin-header-container__title,
.checkout__billing-form .account-address-form-wrapper__title,
.checkout__billing-form .dropin-header-container__title {
    font: var(--type-headline-2-default-font);
    letter-spacing: var(--type-headline-2-default-letter-spacing);
    color: var(--color-neutral-800);
    margin: 0 0 var(--spacing-medium) 0;
}

.checkout__shipping-form .dropin-header-container .dropin-divider,
.checkout__billing-form .dropin-header-container .dropin-divider {
    display: none;
}

@media only screen and (min-width: 320px) and (max-width: 768px) {
    .checkout__main,
    .checkout__aside {
        display: contents;
    }

    .checkout__block {
        order: 3;
    }

    .checkout__heading {
        order: 1;
    }

    .checkout__cart-summary {
        order: 2;
    }

    .checkout__place-order {
        order: 4;
    }
}

@media only screen and (min-width: 768px) {
    .checkout__content {
        display: grid;
        align-items: start;
        grid-template-columns: repeat(var(--grid-4-columns), 1fr);
        gap: var(--spacing-big) var(--grid-4-gutters);
    }

    .checkout__content--error,
    .checkout__content--empty {
        display: grid;
        grid-template-columns: 1fr;
    }

    .checkout__main {
        grid-column: 1 / span 7;
        row-gap: var(--spacing-xbig);
    }

    .checkout__aside {
        grid-column: 9 / span 4;
        gap: var(--spacing-xbig);
    }

    .checkout__place-order {
        margin-top: 0;
    }
}

/* =============================================================================
   PROGRESSIVE DISCLOSURE ADDRESS FORM - Grid Layout
   ============================================================================= */

.checkout-address-address-wrapper {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-medium);
}

/* Hide the default dropin header (not the title) in progressive disclosure layout */
.checkout-address-address-wrapper .dropin-header-container__title,
.checkout-address-address-wrapper .dropin-header-container {
    display: none;
}

/* Form container */
.checkout-address-form-container {
    display: flex;
    flex-direction: column;
}

/* Form uses CSS Grid for 2-column layout */
.checkout-address-form-container form,
.checkout-address-form-container .dropin-form,
.checkout-address-form-container .account-address-form {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: var(--spacing-medium) !important;
}

/* Make wrapper elements AND form transparent so fields become direct grid items */
.checkout-address-form-container .account-address-form-wrapper,
.checkout-address-form-container .account-address-form-wrapper form,
.checkout-address-form-container .account-address-form form,
.checkout-address-form-container form.account-form,
.checkout-address-form-container form.account-address-form,
.checkout-address-form-container .dropin-form__row,
.checkout-address-form-container .dropin-form__fields,
.checkout-address-form-container .account-address-form__row,
.checkout-address-form-container .account-address-form__fields,
.checkout-address-form-container .account-address-form-wrapper__content,
.checkout-address-form-container [class*="__row"],
.checkout-address-form-container [class*="__fields"] {
    display: contents !important;
}

/* Style the title inside the wrapper - spans full width */
.checkout-address-form-container .account-address-form-wrapper__title {
    grid-column: 1 / -1;
    grid-row: 1;
    margin-bottom: var(--spacing-small);
}

/* Hide default shipping/billing checkboxes */
.checkout-address-form-container .account-address-form__field--default_shipping,
.checkout-address-form-container .account-address-form__field--default_billing,
.checkout-address-form-container .account-address-form__field--default_shipping-hidden,
.checkout-address-form-container .account-address-form__field--default_billing-hidden {
    display: none !important;
}

/* Address lookup section - spans full width in grid */
.checkout-address-address-lookup {
    grid-column: 1 / -1;
    grid-row: 4;
}

/* Search icon positioning inside the input */
.checkout-address-address-lookup__input-wrapper {
    position: relative;
}

.checkout-address-address-lookup__icon {
    position: absolute;
    left: var(--spacing-small);
    top: 50%;
    transform: translateY(-50%);
    color: var(--color-neutral-500);
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
    z-index: 1;
}



/* "Enter address manually" toggle link */
.checkout-address-address-toggle {
    background: none;
    border: none;
    padding: var(--spacing-xsmall) 0;
    font: var(--type-body-2-default-font);
    letter-spacing: var(--type-body-2-default-letter-spacing);
    color: var(--color-neutral-800);
    text-decoration: underline;
    cursor: pointer;
    text-align: left;
    width: fit-content;
}

.checkout-address-address-toggle:hover {
    color: var(--color-neutral-600);
}

.checkout-address-address-toggle:hover {
    color: var(--color-neutral-600);
}

/* Hidden fields (email, etc.) */
.checkout-address-hidden-always {
    display: none !important;
}

/* Address fields - hidden by default, shown when expanded */
.checkout-address-address-field {
    display: none;
}

/* Show address fields when expanded */
.checkout-address-address-wrapper--expanded .checkout-address-address-field {
    display: flex !important;
}

/* Ensure all fields take up full width of their grid cell */
.checkout-address-form-container .dropin-field {
    width: 100%;
}

.checkout-address-form-container .dropin-field__content,
.checkout-address-form-container .dropin-input-container,
.checkout-address-form-container .dropin-input-label-container,
.checkout-address-form-container .dropin-input,
.checkout-address-form-container .dropin-picker,
.checkout-address-form-container .dropin-picker__select {
    width: 100%;
}

/* When expanded, move address lookup to bottom (row 10, after company row 9) */
.checkout-address-address-wrapper--expanded .checkout-address-address-lookup {
    grid-row: 10;
}

/* =============================================================================
   ADDRESS AUTOCOMPLETE SUGGESTIONS
   ============================================================================= */

.address-autocomplete-suggestions {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: var(--color-neutral-50, #fff);
    border: 1px solid var(--color-neutral-300, #ccc);
    border-top: none;
    border-radius: 0 0 4px 4px;
    max-height: 250px;
    overflow-y: auto;
    z-index: 1000;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    display: none;
}

.address-autocomplete-suggestion {
    padding: var(--spacing-small, 12px);
    cursor: pointer;
    border-bottom: 1px solid var(--color-neutral-200, #eee);
    transition: background-color 0.15s ease;
}

.address-autocomplete-suggestion:last-child {
    border-bottom: none;
}

.address-autocomplete-suggestion:hover,
.address-autocomplete-suggestion--selected {
    background-color: var(--color-neutral-100, #f5f5f5);
}

.address-autocomplete-suggestion__content {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-xsmall, 8px);
}

.address-autocomplete-suggestion__icon {
    flex-shrink: 0;
    margin-top: 2px;
    color: var(--color-neutral-500);
}

.address-autocomplete-suggestion__text {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.address-autocomplete-suggestion__street {
    font: var(--type-body-2-default-font);
    color: var(--color-neutral-900);
}

.address-autocomplete-suggestion__location {
    font: var(--type-body-2-default-font);
    font-size: 0.85em;
    color: var(--color-neutral-600);
}

.address-autocomplete-no-results {
    padding: var(--spacing-small, 12px);
    color: var(--color-neutral-600);
    font: var(--type-body-2-default-font);
    font-style: italic;
}

/* Ensure input wrapper has relative positioning for dropdown */
.checkout-address-address-lookup .dropin-input-label-container {
    position: relative;
}

/* Responsive: stack fields on mobile (single column) */
@media only screen and (max-width: 767px) {
    .checkout-address-form-container form,
    .checkout-address-form-container .dropin-form,
    .checkout-address-form-container .account-address-form {
        grid-template-columns: 1fr !important;
    }

    .checkout-address-address-wrapper .dropin-field {
        grid-column: 1 !important;
    }
}
